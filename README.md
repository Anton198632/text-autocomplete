# Нейросеть для автодополнения текстов

Нейросеть, которая на основе начала фразы предсказывает её продолжение. 

## Структура проекта

```
text-autocomplete/
├── data/                            # Датасеты
│   ├── tweets.txt                   # "сырой" скачанный датасет
│   ├── dataset_processed.csv        # "очищенный" датасет
│   ├── train.csv                    # тренировочная выборка
│   ├── val.csv                      # валидационная выборка
│   └── test.csv                     # тестовая выборка
│
├── src/                             # Весь код проекта
│   ├── data_utils.py                # Обработка датасета
|   ├── next_token_dataset.py        # код с torch Dataset'ом 
│   ├── lstm_model.py                # код lstm модели
|   ├── eval_lstm.py                 # замер метрик lstm модели
|   ├── lstm_train.py                # код обучения модели
|   ├── eval_transformer_pipeline.py # код с запуском и замером качества трансформера
|   ├── train_history.py             # История обучения (накопление метрик и вывод графиков)
│   └── metric.py                    # Вычисление метрик ROUGE
│
├── models/                          # веса обученных моделей
|
├── solution.ipynb                   # ноутбук с решением на GPU
├── solution-cpu.ipynb               # ноутбук с решением на CPU
├── requirements.txt                 # зависимости проекта при запуске на GPU
├── requirements-cpu.txt             # зависимости проекта при запуске на CPU
└── requirements-dev.txt             # зависимости для разработки (линтер, сортировка импортов)  

```

## Подготовка данных

Перед тем как использовать сеть необходимо её обучить. Скачайте датасет с короткими постами https://code.s3.yandex.net/deep-learning/tweets.txt и расположите в каталоге `./data/`.


## Подготовка виртуального окружения

 Для обучении модели на устройстве CPU или GPU требует установки соответствующих зависимостей.

 1. Активируйте виртуальное окружение, находясь в корневом каталоге проекта:
 ```bash
 source .venv/bin/activate
 ```

 2. Установите зависимости:
 ```bash
# для CPU
pip install -r requirements-cpu.txt

# или для GPU
pip install -r requirements.txt
 ```


## Процесс обучения

Порядок и процесс обучения описан в ноутбуке `./solution.ipynb`


## Результат обучения

После обучения в каталоге `./models/` (или указанном другом каталоге) будут сохранены чекпоинты состояния модели после каждой эпохи обучения.